
## Prueba de Backend Merqueo

La prueba de backend de merqueo se realizo en php y laravel junto con base de datos mysql, sqlite y pruebas con phpunit y postman. 

- Se usa homestead junto con vagrant y virtual box para crear una maquina virtual con todos los requisitos de laravel pre instalados incluidas las bases de datos mysql y sqlite.
- En la capa de [database](https://github.com/sebaxo/backendTest/tree/master/database) y mediante los comandos de php artisan se crean las [migraciones](https://github.com/sebaxo/backendTest/tree/master/database/migrations) iniciales.
- Para acceder a la base de datos se usa la herramienta de eloquent incluida con laravel, para ello se crea una carpeta [Models](https://github.com/sebaxo/backendTest/tree/master/app/Models) en la capa de aplicacion donde se mapean las tablas de la base de datos con sus respectivos atributos. 
- Se crea en la capa de [database](https://github.com/sebaxo/backendTest/tree/master/database) tres repositorios para delegarles el acceso directo a la base de datos, los repositorios de [inventario](https://github.com/sebaxo/backendTest/tree/master/database/InventoryRepository), [ordenes](https://github.com/sebaxo/backendTest/tree/master/database/OrderRepository) y [proveedores](https://github.com/sebaxo/backendTest/tree/master/database/ProviderRepository) incluyen tanto su interfaz como su respectiva implementacion.
- Se crea una carpeta de [dominio](https://github.com/sebaxo/backendTest/tree/master/app/Domain) en la capa de aplicacion donde se va a manejar la logica de negocio de la api rest, estas clases de dominio acceden a los repositorios de base de datos por medio de inyeccion de dependencias.
- El flujo de la informacion se dividio en dos, se creo un controlador pensado solo para los comandos de insersion de datos [InputController](https://github.com/sebaxo/backendTest/blob/master/app/Http/Controllers/InputController.php) y otro para la consulta de la informacion [RequestController](https://github.com/sebaxo/backendTest/blob/master/app/Http/Controllers/RequestController.php), de igual manera se creo una clase de dominio para cada controlador.
- Las clases de dominio se inyectan en los [controladores](https://github.com/sebaxo/backendTest/tree/master/app/Http/Controllers), los que se encargan de decodificar los json y demas entradas y pasarlos a las metodos de las clases de dominio, los controladores heredan de sus respectivas [interfaces](https://github.com/sebaxo/backendTest/tree/master/app/ServiceContracts) pensadas para mapear las entradas y salidas del servicio. 
- Para las pruebas funcionales se usa postman para consumir la api rest y para las pruebas unitarias se usa phpunit, se crea una clase de pruebas por cada controlador [InputModuleTest](https://github.com/sebaxo/backendTest/blob/master/tests/Feature/InputModuleTest.php) y [RequestModuleTest](https://github.com/sebaxo/backendTest/blob/master/tests/Feature/RequestModuleTest.php), para las pruebas se usa la base de datos sqlite incluida en la maquina virtual para no afectar nuestra base de datos mysql, en InputModuleTest se revisa que al realizar las insersiones a la base de datos la cantidad de registros sea la que debe ser y para RequestModuleTest se revisa que la salida de los metodos sea la que debe ser.   

Nota: En el dump de la base de datos ya se incluyen los registros de los json entregados por merqueo, sin embargo para las pruebas se guardaron los json en una [carpeta](https://github.com/sebaxo/backendTest/tree/master/storage/jsons) y cada vez que se ejecutan las pruebas la base de datos sqlite se llena consumiendo los metodos de insersion de datos de la api, la base de datos sqlite se reinicia cada vez que se ejecuta una prueba.
